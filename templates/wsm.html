<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>WSM - Weighted Sum Model</title>
    <!-- Bootswatch Lux theme -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootswatch@5.3.0/dist/lux/bootstrap.min.css">
    


</head>
<body class="container">


        <!-- Home button -->
        <div class="mt-3">
            <a href="/" class="btn btn-outline-primary">
                <i class="fas fa-home"></i> Back to MCDA Home
            </a>
        </div>
    

        <!-- Some vertical space -->
        <div style="height: 30px;"></div>
    
    <!-- Page header -->
    <div class="text-center my-5">
        <h2><strong>WSM ‚Äì Weighted Sum Model</strong></h2>
        <p class="text-muted">1. Enter criteria weights</p>
        <p class="text-muted">2. Select alternatives by checking their boxes</p>
    </div>

    <!-- Some vertical space -->
    <div style="height: 30px;"></div>

    <form method="POST" action="{{ url_for('mcda_bp.wsm') }}">
        <!-- Weights Table -->
        <div class="mcda-table mb-4">
            <h4 class="text-center mb-3">Criteria Weights</h4>
            <table class="table table-bordered">
                <thead class="table-dark">
                    <tr>
                        {% for c in criteria_names %}
                            <th>{{ c }}</th>
                        {% endfor %}
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        {% for i in range(criteria_names|length) %}
                        <td>
                            <input type="number" name="weights" class="form-control"
       value="{{ weight }}" step="any" min="0" max="1">

                        </td>
                        
                        
                        
                        
                        {% endfor %}
                    </tr>
                </tbody>
            </table>
            <p class="text-muted text-center">‚öñÔ∏è The sum of all weights must equal 1.00</p>
        </div>
    

    <form method="POST" action="{{ url_for('mcda_bp.wsm') }}">
        <div class="mcda-table">
            <h4 class="text-center mb-3">Alternatives (Input Data)</h4>
            <table class="table table-bordered table-hover">
                <thead class="table-dark">
                    <tr>
                        <th>Select</th>
                        <th>Company</th>
                        <th>Revenue (M)</th>
                        <th>Revenue Growth %</th>
                        <th>Profit (M)</th>
                        <th>Profit Growth %</th>
                        <th>Assets (M)</th>
                        <th>Employees</th>
                        <th>ROA %</th>
                    </tr>
                </thead>
                <tbody>
                {% for comp in companies %}
                    <tr>
                        <td>
                            <input type="checkbox" name="selected_companies" value="{{ comp.name }}"
                                   {% if comp.name in selected_names %}checked{% endif %}>
                        </td>
                        <td>{{ comp.name }}</td>
                        <td>{{ comp.revenues_million }}</td>
                        <td>{{ comp.revenue_percent_change }}</td>
                        <td>{{ comp.profits_million }}</td>
                        <td>{{ comp.profits_percent_change }}</td>
                        <td>{{ comp.assets_million }}</td>
                        <td>{{ comp.employees }}</td>
                        <td>
                            {{ "%.2f"|format((comp.profits_million / comp.assets_million * 100) if comp.assets_million else 0) }}
                        </td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
    
        <div class="text-center my-3">
            <button type="submit" class="btn btn-primary">Run WSM Calculation</button>
        </div>
    </form>
    

    <!-- Space before second table -->
    <div style="height: 50px;"></div>


    
    <!-- Normalized & Weighted Scores -->
    {% if results %}
    <div class="mcda-table">
        <h4 class="text-center mb-3">Normalized, Weighted Scores and Final Result</h4>
        <table class="table table-bordered table-hover">
            <thead class="table-dark">
                <tr>
                    <th rowspan="2">Company</th>
                    {% for c in criteria_names %}
                        <th colspan="2">{{ c }}</th>
                    {% endfor %}
                    <th rowspan="2">WSM Score</th>
                </tr>
                <tr>
                    {% for c in criteria_names %}
                        <th>Norm</th>
                        <th>Weighted</th>
                    {% endfor %}
                </tr>
            </thead>
            <tbody>
            {% for res in results %}
                <tr>
                    <td>{{ res.name }}</td>
                    {% for norm, weighted in res.pairs %}
                        <td>{{ "%.3f"|format(norm) }}</td>
                        <td>{{ "%.3f"|format(weighted) }}</td>
                    {% endfor %}
                    <td><strong>{{ res.score }}</strong></td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
    {% endif %}

    <!-- Space before decision -->
    <div style="height: 50px;"></div>

    {% if results %}
    {% set best = results | max(attribute='score') %}
    <div class="text-center my-4 p-3 border rounded bg-light">
        <h4>üèÜ Final Decision (WSM): <strong>{{ best.name }}</strong></h4>
        <p>Highest score: <strong>{{ best.score }}</strong></p>
    </div>
{% endif %}


</body>
</html>
